<section id="pricing" class="uk-section uk-section-default">
    <div class="uk-container">
        <h2 class="uk-heading-medium uk-text-center">Get Your Copy Today</h2>
        <div class="uk-card uk-card-default uk-card-body uk-width-1-2@m uk-align-center">
            <h3 class="uk-card-title uk-text-center">AI WebDev Pro Book</h3>
            <p class="uk-text-lead uk-text-center">Unlock the Power of AI in Web Development</p>
            <div class="uk-text-center uk-margin-medium-top">
                <span class="uk-text-large uk-text-bold">$29.99</span>
                <p class="uk-text-muted">One-time purchase, lifetime access</p>
            </div>
            <ul class="uk-list uk-list-bullet uk-margin-medium-top">
                <li>500+ pages of in-depth content</li>
                <li>Practical examples and case studies</li>
                <li>Access to exclusive online resources</li>
                <li>Regular updates as AI technology evolves</li>
            </ul>
            <div class="uk-text-center uk-margin-medium-top">
                <button id="purchase-button" class="uk-button uk-button-primary uk-button-large">
                    <i class="ti-shopping-cart uk-margin-small-right"></i>
                    Buy Now
                </button>
            </div>
        </div>
    </div>
</section>

<div id="purchase-modal" uk-modal>
    <div class="uk-modal-dialog uk-modal-body">
        <h2 class="uk-modal-title">Complete Your Purchase</h2>
        <form id="order-form" class="uk-form-stacked">
            <div class="uk-margin">
                <label class="uk-form-label" for="customer-name">Full Name</label>
                <div class="uk-form-controls">
                    <input class="uk-input" id="customer-name" type="text" required>
                </div>
            </div>
            <div class="uk-margin">
                <label class="uk-form-label" for="customer-email">Email Address</label>
                <div class="uk-form-controls">
                    <input class="uk-input" id="customer-email" type="email" required>
                </div>
            </div>
            <div class="uk-margin">
                <label class="uk-form-label" for="card-element">Credit or Debit Card</label>
                <div id="card-element" class="uk-margin-small-top"></div>
                <div id="card-errors" role="alert" class="uk-text-danger uk-margin-small-top"></div>
            </div>
            <div class="uk-text-right">
                <button class="uk-button uk-button-default uk-modal-close" type="button">Cancel</button>
                <button class="uk-button uk-button-primary" type="submit">Complete Purchase</button>
            </div>
        </form>
    </div>
</div>

<script src="https://js.stripe.com/v3/"></script>
<script>
    const stripe = Stripe('your_stripe_public_key');
    const elements = stripe.elements();
    const cardElement = elements.create('card');
    cardElement.mount('#card-element');

    const purchaseButton = document.getElementById('purchase-button');
    const modal = UIkit.modal("#purchase-modal");
    purchaseButton.addEventListener('click', () => {
        modal.show();
    });

    const form = document.getElementById('order-form');
    form.addEventListener('submit', async (event) => {
        event.preventDefault();
        const customerName = document.getElementById('customer-name').value;
        const customerEmail = document.getElementById('customer-email').value;

        const { token, error } = await stripe.createToken(cardElement);

        if (error) {
            const errorElement = document.getElementById('card-errors');
            errorElement.textContent = error.message;
        } else {
            const response = await fetch('/order', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    customerName,
                    customerEmail,
                    token: token.id
                })
            });

            if (response.ok) {
                UIkit.notification({
                    message: 'Purchase successful! Check your email for order details.',
                    status: 'success'
                });
                modal.hide();
            } else {
                UIkit.notification({
                    message: 'An error occurred. Please try again.',
                    status: 'danger'
                });
            }
        }
    });
</script>